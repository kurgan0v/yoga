# Профиль пользователя: Детальное описание флоу

## Общая схема работы профиля

1. **Главная страница профиля**
   - Отображение информации о пользователе (имя, фото, статус "Ученик")
   - Общая статистика
   - Кнопки для управления профилем
   - Доступ к дополнительным функциям через таб-бар

2. **Регистрация и вход**
   - Авторизация через Telegram
   - Хранение данных пользователя в таблице Supabase users

3. **Отслеживание прогресса**
   - Функция "До/После" с возможностью загрузки фотографий
   - История практик с датами
   - Визуальное отображение изменений

## Детальное описание экранов

### Экран "Личный кабинет"
1. **Основная информация**
   - Фото пользователя в круглом аватаре
   - Имя пользователя (из данных Telegram)
   - Статус "Ученик" 

2. **Функциональные кнопки**
   - Четыре основные кнопки управления профилем:
     - Настройки
     - История практик
     - Достижения
     - Статистика

3. **Дополнительные блоки**
   - Блок "Калькулятор" для отслеживания показателей
   - Блок настроек уведомлений
   - Кнопка "Пригласить друга"

### Экран "До/После" (трекинг прогресса)

#### Первый вход
1. **Онбординг**
   - Заголовок "Давай зафиксируем твое состояние сейчас"
   - Пояснительный текст о важности отслеживания прогресса
   - Два блока для загрузки фотографий (до/после)
   - Кнопка для продолжения
   - Информация о согласии с политикой конфиденциальности

2. **Процесс загрузки фото**
   - Блоки с надписью "Нажми, чтобы загрузить фото"
   - После загрузки отображаются фотографии
   - Возможность заменить фото

#### Последующие входы
1. **Визуализация прогресса**
   - Заголовок "Тут ты можешь отследить свой прогресс"
   - Отображение загруженных ранее фотографий с датами
   - Новый блок для загрузки актуальных фотографий
   - Текстовое сравнение состояний "Было" / "Стало"

2. **Завершение этапа**
   - Сообщение "Мы вернемся к тебе через 2 недели"
   - Поздравительное сообщение "Ты молодчина!"
   - Кнопка для возврата в профиль

### Дополнительные функции

1. **Групповые активности**
   - Предложение "Объединиться в тройки для решения своего запроса"
   - Краткое описание преимуществ
   - Кнопки "Согласиться" и "Отказаться"

2. **Напоминания о практиках**
   - Система уведомлений о регулярных практиках
   - Напоминания о необходимости отслеживания прогресса

## Логика работы с Supabase

1. **Хранение данных пользователя**
   - Таблица users для хранения информации пользователя из Telegram:
     - id (UUID, primary key)
     - telegram_id (BIGINT, уникальный)
     - first_name, last_name, username из Telegram
     - photo_url для аватара
     - auth_date и hash для аутентификации
     - last_login, created_at, updated_at для отслеживания активности

2. **Таблица для отслеживания прогресса**
   - Связь с пользователем по telegram_id
   - Хранение URL изображений "до" и "после"
   - Даты загрузки фотографий
   - Текстовые описания состояний

3. **Индексы и триггеры**
   - Индекс по telegram_id для быстрого поиска
   - Триггер для автоматического обновления поля updated_at

## Интеграция с Telegram Mini App

1. **Аутентификация**
   - Использование Telegram Web App API для передачи данных пользователя
   - Проверка целостности данных через hash
   - Автоматическое обновление информации при изменениях в профиле

2. **Хранение сессии**
   - Данные пользователя хранятся в React контексте (UserContext)
   - Локальное кеширование через localStorage для сохранения сессии
   - Автоматическое обновление данных профиля при входе

## Взаимодействие с другими разделами

1. **Связь с главной страницей**
   - Отображение базовой информации о пользователе
   - Доступ к основным функциям через таб-бар

2. **Связь с календарем**
   - Отображение запланированных практик
   - Напоминания о предстоящих событиях

3. **Связь с библиотекой**
   - Отслеживание пройденных материалов
   - Сохранение избранных практик

4. **Связь с квизом**
   - Персонализация предлагаемых практик на основе прогресса
   - Адаптация рекомендаций в зависимости от активности 