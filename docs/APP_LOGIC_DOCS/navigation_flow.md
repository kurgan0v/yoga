# Навигация в Telegram Mini App

## Общая структура навигации

Навигация в приложении построена с учетом особенностей Telegram Mini Apps и использует React Router вместе с хуками и компонентами из `@telegram-apps/sdk-react` и `@telegram-apps/telegram-ui`.

## Основные компоненты навигации

1. **HashRouter**
   - Используется для маршрутизации в Telegram Mini Apps
   - В отличие от BrowserRouter более совместим с окружением Telegram

2. **Page компонент**
   - Обертка для всех страниц приложения
   - Добавляет стандартный хедер Telegram с кнопкой "назад"
   - Контролирует переходы между страницами

3. **Link компонент**
   - Обертка над стандартным Link из React Router
   - Адаптирован для работы в контексте Telegram UI

## Навигация назад

В Telegram Mini Apps навигация назад имеет ряд особенностей:

1. **Кнопка назад в хедере**
   - Находится в верхнем левом углу экрана
   - По умолчанию вызывает стандартную навигацию назад
   - Можно переопределить поведение через props `onBack`

2. **Жесты свайпа**
   - В iOS и некоторых Android клиентах жест свайпа справа налево вызывает переход назад
   - Поведение аналогично нажатию на кнопку назад

3. **Параметр `back`**
   - У компонента `<Page>` есть параметр `back={boolean}` 
   - Если установлен в `false`, кнопка назад не отображается (используется для главной страницы)
   - Если установлен в `true` или не указан, отображается кнопка назад

## Реализация в коде

```tsx
// Пример использования Page компонента с кнопкой назад
<Page>
  <YourContent />
</Page>

// Главная страница без кнопки назад
<Page back={false}>
  <YourContent />
</Page>

// Страница с кастомным обработчиком нажатия кнопки назад
<Page onBack={() => {
  // Кастомная логика
  console.log('Custom back action');
  history.push('/some-other-route');
}}>
  <YourContent />
</Page>
```

## Важные замечания

1. **Избегайте навигации за пределы приложения**
   - Пользователь должен иметь возможность вернуться в исходное состояние приложения
   - Не перенаправляйте на внешние URL без явного разрешения пользователя

2. **Контроль истории навигации**
   - Помните, что кнопка назад в Telegram всегда доступна
   - Структурируйте навигацию так, чтобы пользователь всегда понимал, куда вернется при нажатии кнопки назад

3. **Глубина вложенности**
   - Старайтесь ограничивать глубину вложенности экранов, слишком глубокая вложенность затрудняет навигацию

4. **Взаимодействие с Telegram API**
   - Для некоторых операций (например, полноэкранный режим) используются специальные методы Telegram API через `postEvent`
   - Примеры: `postEvent('web_app_request_fullscreen')`, `postEvent('web_app_exit_fullscreen')`

## Таб-бар и основная навигация

Основная навигация в приложении реализована через таб-бар с четырьмя основными разделами:
- Главная
- Библиотека
- Календарь
- Профиль

Переключение между этими вкладками осуществляется через соответствующие компоненты и маршруты. 